name: export-dataset
on:
  push:
    branches:
      - main
jobs:
  export:
    runs-on: ubuntu-latest
    steps:
      - name: checkout
        uses: actions/checkout@v4
      - name: setup python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"
      - name: export
        run: |
          python -m pip install --upgrade pyarrow
          python datasets/export_to_hf.py --out datasets/export.parquet
      - name: upload to hf
        env:
          HF_TOKEN: ${{ secrets.HF_TOKEN }}
          HF_REPO: ${{ secrets.HF_REPO }}
        run: |
          python -m pip install --upgrade huggingface_hub
          python datasets/push_to_hf.py --repo "$HF_REPO" --token "$HF_TOKEN" \
            --files datasets/export.parquet datasets/schema.json datasets/DATASET_CARD.md
      - name: upload artifact
        uses: actions/upload-artifact@v4
        with:
          name: vc-fcst-export
          path: datasets/export.parquet
